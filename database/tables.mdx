---
title: Table Management
description: Create, modify, and manage database tables dynamically through the InsForge API
---

# Table Management

InsForge provides a powerful API for dynamically creating and managing database tables. Create tables on-the-fly, modify schemas, and manage relationships without writing SQL.

## Creating Tables

### Basic Table Creation

Create a new table with columns:

```bash
curl -X POST http://localhost:7130/api/database/tables \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "products",
    "columns": [
      {"name": "name", "type": "STRING"},
      {"name": "price", "type": "FLOAT"},
      {"name": "description", "type": "STRING"},
      {"name": "in_stock", "type": "BOOLEAN", "defaultValue": true}
    ]
  }'
```

### With Row Level Security

Enable RLS when creating a table:

```bash
curl -X POST http://localhost:7130/api/database/tables \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "user_posts",
    "rlsEnabled": true,
    "columns": [
      {"name": "user_id", "type": "UUID"},
      {"name": "title", "type": "STRING"},
      {"name": "content", "type": "STRING"},
      {"name": "published", "type": "BOOLEAN", "defaultValue": false}
    ]
  }'
```

## Column Types

### Available Types

| Type | PostgreSQL Type | Use Case | Default Value |
|------|----------------|----------|---------------|
| STRING | TEXT | Text data of any length | `null` |
| INTEGER | INTEGER | Whole numbers (-2^31 to 2^31-1) | `null` |
| FLOAT | DOUBLE PRECISION | Decimal numbers | `null` |
| BOOLEAN | BOOLEAN | True/false values | `false` |
| DATETIME | TIMESTAMPTZ | Dates and times with timezone | `CURRENT_TIMESTAMP` |
| UUID | UUID | Unique identifiers | `gen_random_uuid()` |
| JSON | JSONB | Structured JSON data | `'{}'::jsonb` |

### Column Options

```typescript
interface Column {
  name: string;
  type: ColumnType;
  defaultValue?: any;     // Default value for the column
  nullable?: boolean;      // Allow NULL values (default: true)
  unique?: boolean;        // Enforce uniqueness
}
```

## Automatic Fields

Every table automatically includes these fields:

```sql
id         UUID PRIMARY KEY DEFAULT gen_random_uuid()
created_at TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP
updated_at TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP
```

<Note>
The `updated_at` field is automatically updated via a trigger whenever a row is modified.
</Note>

## Modifying Tables

### Add Column

```bash
curl -X PATCH http://localhost:7130/api/database/tables/products \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "ADD_COLUMN",
    "column": {
      "name": "category",
      "type": "STRING",
      "defaultValue": "general"
    }
  }'
```

### Drop Column

```bash
curl -X PATCH http://localhost:7130/api/database/tables/products \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "DROP_COLUMN",
    "columnName": "description"
  }'
```

### Rename Column

```bash
curl -X PATCH http://localhost:7130/api/database/tables/products \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "RENAME_COLUMN",
    "oldName": "in_stock",
    "newName": "available"
  }'
```

### Update Column Default

```bash
curl -X PATCH http://localhost:7130/api/database/tables/products \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "UPDATE_COLUMN",
    "columnName": "price",
    "defaultValue": 0.00
  }'
```

## Foreign Keys

### Add Foreign Key

Create relationships between tables:

```bash
curl -X PATCH http://localhost:7130/api/database/tables/orders \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "ADD_FOREIGN_KEY",
    "foreignKey": {
      "column": "user_id",
      "referencedTable": "user",
      "referencedColumn": "id",
      "onDelete": "CASCADE",
      "onUpdate": "CASCADE"
    }
  }'
```

### Foreign Key Actions

| Action | Description |
|--------|-------------|
| CASCADE | Delete/update related records |
| SET NULL | Set foreign key to NULL |
| SET DEFAULT | Set to column's default value |
| RESTRICT | Prevent if related records exist |
| NO ACTION | Similar to RESTRICT (PostgreSQL default) |

### Drop Foreign Key

```bash
curl -X PATCH http://localhost:7130/api/database/tables/orders \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "DROP_FOREIGN_KEY",
    "constraintName": "orders_user_id_fkey"
  }'
```

## Table Information

### List All Tables

```bash
curl http://localhost:7130/api/database/tables \
  -H "Authorization: Bearer YOUR_TOKEN"
```

Response:
```json
{
  "tables": [
    {
      "name": "products",
      "columns": [
        {"name": "id", "type": "uuid", "nullable": false},
        {"name": "name", "type": "text", "nullable": true},
        {"name": "price", "type": "double precision", "nullable": true}
      ],
      "recordCount": 42
    }
  ]
}
```

### Get Table Schema

```bash
curl http://localhost:7130/api/database/tables/products/schema \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## Deleting Tables

<Warning>
Deleting a table permanently removes all data. This action cannot be undone.
</Warning>

```bash
curl -X DELETE http://localhost:7130/api/database/tables/products \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## Best Practices

### Naming Conventions

- Use lowercase with underscores: `user_profiles`, not `UserProfiles`
- Use descriptive names: `product_categories` not `pc`
- Avoid PostgreSQL reserved words
- Keep names under 63 characters

### Table Design

1. **Normalize Data**: Avoid duplicating data across tables
2. **Use Foreign Keys**: Maintain referential integrity
3. **Index Frequently Queried Columns**: Improve query performance
4. **Use Appropriate Types**: Choose the right data type for each column
5. **Set Defaults**: Provide sensible defaults where applicable

### Reserved Names

These field names are reserved and cannot be used:

- `id` - Auto-generated primary key
- `created_at` - Creation timestamp
- `updated_at` - Modification timestamp

System tables (prefixed with `_`) cannot be modified:
- `_user`, `_account`, `_config`, `_storage`, `_metadata`, etc.

## JavaScript/TypeScript Examples

### Create Table

```typescript
async function createTable() {
  const response = await fetch('http://localhost:7130/api/database/tables', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      name: 'products',
      columns: [
        { name: 'name', type: 'STRING' },
        { name: 'price', type: 'FLOAT' },
        { name: 'in_stock', type: 'BOOLEAN', defaultValue: true }
      ]
    })
  });
  
  return response.json();
}
```

### Add Column with Error Handling

```typescript
async function addColumn(tableName: string, column: Column) {
  try {
    const response = await fetch(`/api/database/tables/${tableName}`, {
      method: 'PATCH',
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        action: 'ADD_COLUMN',
        column
      })
    });
    
    if (!response.ok) {
      const error = await response.json();
      throw new Error(error.message);
    }
    
    return response.json();
  } catch (error) {
    console.error('Failed to add column:', error);
    throw error;
  }
}
```

## Next Steps

<CardGroup cols={2}>
  <Card title="PostgREST API" href="/database/postgrest">
    Learn about the automatic REST API
  </Card>
  <Card title="Queries" href="/database/queries">
    Master advanced query techniques
  </Card>
</CardGroup>